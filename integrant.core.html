<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>integrant.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Integrant</span> <span class="project-version">0.11.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="integrant.core.html"><div class="inner"><span>integrant.core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="integrant.core.html#var-assert-key"><div class="inner"><span>assert-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-build"><div class="inner"><span>build</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-composite-keyword"><div class="inner"><span>composite-keyword</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-converge"><div class="inner"><span>converge</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-dependency-graph"><div class="inner"><span>dependency-graph</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-derived-from.3F"><div class="inner"><span>derived-from?</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-expand"><div class="inner"><span>expand</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-expand-key"><div class="inner"><span>expand-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-find-derived"><div class="inner"><span>find-derived</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-find-derived-1"><div class="inner"><span>find-derived-1</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-fold"><div class="inner"><span>fold</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-halt.21"><div class="inner"><span>halt!</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-halt-key.21"><div class="inner"><span>halt-key!</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-init"><div class="inner"><span>init</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-init-key"><div class="inner"><span>init-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-key-comparator"><div class="inner"><span>key-comparator</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-load-hierarchy"><div class="inner"><span>load-hierarchy</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-load-namespaces"><div class="inner"><span>load-namespaces</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-normalize-key"><div class="inner"><span>normalize-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-prep"><div class="inner"><span>prep</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-prep-key"><div class="inner"><span>prep-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-read-string"><div class="inner"><span>read-string</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-ref"><div class="inner"><span>ref</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-ref.3F"><div class="inner"><span>ref?</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-RefLike"><div class="inner"><span>RefLike</span></div></a></li><li class="depth-2 branch"><a href="integrant.core.html#var-ref-key"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ref-key</span></div></a></li><li class="depth-2"><a href="integrant.core.html#var-ref-resolve"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ref-resolve</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-reflike.3F"><div class="inner"><span>reflike?</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-refset"><div class="inner"><span>refset</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-refset.3F"><div class="inner"><span>refset?</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-resolve-key"><div class="inner"><span>resolve-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-resume"><div class="inner"><span>resume</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-resume-key"><div class="inner"><span>resume-key</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-reverse-run.21"><div class="inner"><span>reverse-run!</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-run.21"><div class="inner"><span>run!</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-suspend.21"><div class="inner"><span>suspend!</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-suspend-key.21"><div class="inner"><span>suspend-key!</span></div></a></li><li class="depth-1"><a href="integrant.core.html#var-valid-config-key.3F"><div class="inner"><span>valid-config-key?</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">integrant.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-assert-key"><h3>assert-key</h3><h4 class="type">multimethod</h4><div class="usage"><code>(assert-key key value)</code></div><div class="doc"><div class="markdown"><p>Check that the value of a key is correct immediately before the key is initiated. If the value is incorrect, an appropriate exception should be thrown.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L442">view source</a></div></div><div class="public anchor" id="var-build"><h3>build</h3><div class="usage"><code>(build config keys f)</code><code>(build config keys f assertf)</code><code>(build config keys f assertf resolvef)</code></div><div class="doc"><div class="markdown"><p>Apply a function f to each key value pair in a configuration map. Keys are traversed in dependency order, and any references in the value expanded. The function should take two arguments, a key and value, and return a new value. An optional fourth argument, assertf, may be supplied to provide an assertion check on the system, key and expanded value.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L344">view source</a></div></div><div class="public anchor" id="var-composite-keyword"><h3>composite-keyword</h3><div class="usage"><code>(composite-keyword kws)</code></div><div class="doc"><div class="markdown"><p>Return a unique keyword that is derived from an ordered collection of keywords. The function will return the same keyword for the same collection.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L14">view source</a></div></div><div class="public anchor" id="var-converge"><h3>converge</h3><div class="usage"><code>(converge m)</code><code>(converge m override-map)</code></div><div class="doc"><div class="markdown"><p>Deep-merge the values of a map. Raises an error on conflicting keys, unless an override is specified via the override-map.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L514">view source</a></div></div><div class="public anchor" id="var-dependency-graph"><h3>dependency-graph</h3><div class="usage"><code>(dependency-graph config)</code><code>(dependency-graph config {:keys [include-refsets?], :or {include-refsets? true}})</code></div><div class="doc"><div class="markdown"><p>Return a dependency graph of all the refs and refsets in a config. Resolves derived dependencies. Takes the following options:</p>
<dl>
<dt><code>:include-refsets?</code></dt>
<dd>whether to include refsets in the dependency graph (defaults to true)</dd>
</dl>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L131">view source</a></div></div><div class="public anchor" id="var-derived-from.3F"><h3>derived-from?</h3><div class="usage"><code>(derived-from? key candidate)</code></div><div class="doc"><div class="markdown"><p>Return true if a key is derived from candidate keyword or vector of keywords.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L46">view source</a></div></div><div class="public anchor" id="var-expand"><h3>expand</h3><div class="usage"><code>(expand config)</code><code>(expand config keys)</code></div><div class="doc"><div class="markdown"><p>Expand modules in the config map prior to initiation. The <a href="integrant.core.html#var-expand-key">expand-key</a> method is applied to each entry in the map to create an expansion, and the results are deep-merged together using <a href="integrant.core.html#var-converge">converge</a> to produce a new configuration.</p>
<p>If two expansions generate different values for the same keys, an exception will be raised. Configuration values that do not come from an expansion will override keys from expansions, allowing conflicts to be resolved by user- defined values.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L529">view source</a></div></div><div class="public anchor" id="var-expand-key"><h3>expand-key</h3><h4 class="type">multimethod</h4><div class="usage"><code>(expand-key key value)</code></div><div class="doc"><div class="markdown"><p>Expand a config value into a map that is then merged back into the config. Defaults to returning a map <code>{key value}</code>. See: <a href="integrant.core.html#var-expand">expand</a>.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L387">view source</a></div></div><div class="public anchor" id="var-find-derived"><h3>find-derived</h3><div class="usage"><code>(find-derived m k)</code></div><div class="doc"><div class="markdown"><p>Return a seq of all entries in a map, m, where the key is derived from the a candidate key, k. If there are no matching keys, nil is returned. The candidate key may be a keyword, or vector of keywords.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L55">view source</a></div></div><div class="public anchor" id="var-find-derived-1"><h3>find-derived-1</h3><div class="usage"><code>(find-derived-1 m k)</code></div><div class="doc"><div class="markdown"><p>Return the map entry in a map, m, where the key is derived from the keyword, k. If there are no matching keys, nil is returned. If there is more than one matching key, an ambiguous key exception is raised.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L116">view source</a></div></div><div class="public anchor" id="var-fold"><h3>fold</h3><div class="usage"><code>(fold system f val)</code></div><div class="doc"><div class="markdown"><p>Reduce all the key value pairs in system map in dependency order, starting from an initial value. The function should take three arguments: the accumulator, the current key and the current value.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L313">view source</a></div></div><div class="public anchor" id="var-halt.21"><h3>halt!</h3><div class="usage"><code>(halt! system)</code><code>(halt! system keys)</code></div><div class="doc"><div class="markdown"><p>Halt a system map by applying <a href="integrant.core.html#var-halt-key.21">halt-key!</a> in reverse dependency order.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L560">view source</a></div></div><div class="public anchor" id="var-halt-key.21"><h3>halt-key!</h3><h4 class="type">multimethod</h4><div class="usage"><code>(halt-key! key value)</code></div><div class="doc"><div class="markdown"><p>Halt a running or suspended implementation associated with a key. This is often used for stopping processes or cleaning up resources. For example, a database connection might be closed. This multimethod must be idempotent. The return value of this multimethod is discarded.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L410">view source</a></div></div><div class="public anchor" id="var-init"><h3>init</h3><div class="usage"><code>(init config)</code><code>(init config keys)</code></div><div class="doc"><div class="markdown"><p>Turn a config map into an system map. Keys are traversed in dependency order, initiated via the <a href="integrant.core.html#var-init-key">init-key</a> multimethod, then the refs associated with the key are resolved.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L550">view source</a></div></div><div class="public anchor" id="var-init-key"><h3>init-key</h3><h4 class="type">multimethod</h4><div class="usage"><code>(init-key key value)</code></div><div class="doc"><div class="markdown"><p>Turn a config value associated with a key into a concrete implementation. For example, a database URL might be turned into a database connection.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L393">view source</a></div></div><div class="public anchor" id="var-key-comparator"><h3>key-comparator</h3><div class="usage"><code>(key-comparator graph)</code></div><div class="doc"><div class="markdown"><p>Create a key comparator from the dependency graph of a configuration map. The comparator is deterministic; it will always result in the same key order.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L146">view source</a></div></div><div class="public anchor" id="var-load-hierarchy"><h3>load-hierarchy</h3><div class="usage"><code>(load-hierarchy)</code><code>(load-hierarchy path)</code></div><div class="doc"><div class="markdown"><p>Search the base classpath for all resources that share the same path (by default <code>integrant/hierarchy.edn</code>), and use their contents to extend the global <code>derive</code> hierarchy. This allows a hierarchy to be constructed without needing to load every namespace.</p>
<p>The hierarchy resources should be edn files that map child keywords to vectors of parents. For example:</p>
<pre><code>{:example/child [:example/father :example/mother]}
</code></pre>
<p>This is equivalent:</p>
<pre><code>(derive :example/child :example/father)
(derive :example/child :example/mother)
</code></pre>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L217">view source</a></div></div><div class="public anchor" id="var-load-namespaces"><h3>load-namespaces</h3><div class="usage"><code>(load-namespaces config)</code><code>(load-namespaces config keys)</code></div><div class="doc"><div class="markdown"><p>Attempt to load the namespaces referenced by the keys in a configuration. If a key is namespaced, both the namespace and the namespace concatenated with the name will be tried. For example, if a key is <code>:foo.bar/baz</code>, then the function will attempt to load the namespaces <code>foo.bar</code> and <code>foo.bar.baz</code>. Upon completion, a list of all loaded namespaces will be returned.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L195">view source</a></div></div><div class="public anchor" id="var-normalize-key"><h3>normalize-key</h3><div class="usage"><code>(normalize-key key)</code></div><div class="doc"><div class="markdown"><p>Given a valid Integrant key, return a keyword that uniquely identifies it.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L40">view source</a></div></div><div class="public anchor" id="var-prep"><h3>prep</h3><h4 class="deprecated">deprecated in 0.9.0</h4><div class="usage"><code>(prep config)</code><code>(prep config keys)</code></div><div class="doc"><div class="markdown"><p>Prepare a config map for initiation. The <a href="integrant.core.html#var-prep-key">prep-key</a> method is applied to each entry in the map, and the values replaced with the return value. This is used for adding default values and references to the configuration.</p>
<p>Deprecated in favor of <a href="integrant.core.html#var-expand">expand</a>.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L464">view source</a></div></div><div class="public anchor" id="var-prep-key"><h3>prep-key</h3><h4 class="type">multimethod</h4><h4 class="deprecated">deprecated in 0.9.0</h4><div class="usage"><code>(prep-key key value)</code></div><div class="doc"><div class="markdown"><p>Prepare the configuration associated with a key for initiation. This is generally used to add in default values and references. By default the method returns the value unaltered.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L378">view source</a></div></div><div class="public anchor" id="var-read-string"><h3>read-string</h3><div class="usage"><code>(read-string s)</code><code>(read-string opts s)</code></div><div class="doc"><div class="markdown"><p>Read a config from a string of edn. Refs may be denotied by tagging keywords with <code>#ig/ref</code>.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L168">view source</a></div></div><div class="public anchor" id="var-ref"><h3>ref</h3><div class="usage"><code>(ref key)</code></div><div class="doc"><div class="markdown"><p>Create a reference to a top-level key in a config map.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L76">view source</a></div></div><div class="public anchor" id="var-ref.3F"><h3>ref?</h3><div class="usage"><code>(ref? x)</code></div><div class="doc"><div class="markdown"><p>Return true if its argument is a ref.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L90">view source</a></div></div><div class="public anchor" id="var-RefLike"><h3>RefLike</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-ref-key"><h3>ref-key</h3><div class="usage"><code>(ref-key r)</code></div><div class="doc"><div class="markdown"><p>Return the key of the reference.</p>
</div></div></div><div class="public anchor" id="var-ref-resolve"><h3>ref-resolve</h3><div class="usage"><code>(ref-resolve r config resolvef)</code></div><div class="doc"><div class="markdown"><p>Return the resolved value.</p>
</div></div></div></div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L10">view source</a></div></div><div class="public anchor" id="var-reflike.3F"><h3>reflike?</h3><div class="usage"><code>(reflike? x)</code></div><div class="doc"><div class="markdown"><p>Return true if its argument is a ref or a refset.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L100">view source</a></div></div><div class="public anchor" id="var-refset"><h3>refset</h3><div class="usage"><code>(refset key)</code></div><div class="doc"><div class="markdown"><p>Create a set of references to all matching top-level keys in a config map.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L83">view source</a></div></div><div class="public anchor" id="var-refset.3F"><h3>refset?</h3><div class="usage"><code>(refset? x)</code></div><div class="doc"><div class="markdown"><p>Return true if its argument is a refset.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L95">view source</a></div></div><div class="public anchor" id="var-resolve-key"><h3>resolve-key</h3><h4 class="type">multimethod</h4><div class="usage"><code>(resolve-key key value)</code></div><div class="doc"><div class="markdown"><p>Return a value to substitute for a reference prior to initiation. By default the value of the key is returned unaltered. This can be used to hide information that is only necessary to halt or suspend the key.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L369">view source</a></div></div><div class="public anchor" id="var-resume"><h3>resume</h3><div class="usage"><code>(resume config system)</code><code>(resume config system keys)</code></div><div class="doc"><div class="markdown"><p>Turn a config map into a system map, reusing resources from an existing system when itâ€™s possible to do so. Keys are traversed in dependency order, resumed with the <a href="integrant.core.html#var-resume-key">resume-key</a> multimethod, then the refs associated with the key are resolved.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L577">view source</a></div></div><div class="public anchor" id="var-resume-key"><h3>resume-key</h3><h4 class="type">multimethod</h4><div class="usage"><code>(resume-key key value old-value old-impl)</code></div><div class="doc"><div class="markdown"><p>Turn a config value associated with a key into a concrete implementation, but reuse resources (e.g. connections, running threads, etc) from an existing implementation. By default this multimethod calls init-key and ignores the additional argument.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L420">view source</a></div></div><div class="public anchor" id="var-reverse-run.21"><h3>reverse-run!</h3><div class="usage"><code>(reverse-run! system keys f)</code></div><div class="doc"><div class="markdown"><p>Apply a side-effectful function f to each key value pair in a system map. Keys are traversed in reverse dependency order. The function should take two arguments, a key and value.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L305">view source</a></div></div><div class="public anchor" id="var-run.21"><h3>run!</h3><div class="usage"><code>(run! system keys f)</code></div><div class="doc"><div class="markdown"><p>Apply a side-effectful function f to each key value pair in a system map. Keys are traversed in dependency order. The function should take two arguments, a key and value.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L297">view source</a></div></div><div class="public anchor" id="var-suspend.21"><h3>suspend!</h3><div class="usage"><code>(suspend! system)</code><code>(suspend! system keys)</code></div><div class="doc"><div class="markdown"><p>Suspend a system map by applying <a href="integrant.core.html#var-suspend-key.21">suspend-key!</a> in reverse dependency order.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L595">view source</a></div></div><div class="public anchor" id="var-suspend-key.21"><h3>suspend-key!</h3><h4 class="type">multimethod</h4><div class="usage"><code>(suspend-key! key value)</code></div><div class="doc"><div class="markdown"><p>Suspend a running implementation associated with a key, so that it may be eventually passed to resume-key. By default this multimethod calls <a href="integrant.core.html#var-halt-key.21">halt-key!</a>, but it may be customized to do things like keep a server running, but buffer incoming requests until the server is resumed.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L431">view source</a></div></div><div class="public anchor" id="var-valid-config-key.3F"><h3>valid-config-key?</h3><div class="usage"><code>(valid-config-key? key)</code></div><div class="doc"><div class="markdown"><p>Return true if the key is a keyword or valid composite key.</p>
</div></div><div class="src-link"><a href="http://github.com/weavejester/integrant/blob/0.11.0/src/integrant/core.cljc#L35">view source</a></div></div></div></body></html>